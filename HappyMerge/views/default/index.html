{{left_sidebar_enabled,right_sidebar_enabled=False,('message' in globals())}}
{{extend 'layout.html'}}
<script src="http://maps.google.com/maps/api/js?sensor=true"></script>
<script src="{{=URL('static','js/gmaps.js')}}"></script>
<script src="{{=URL('static','js/jquery.js')}}"></script>
<style type="text/css">
#top_part{
    width: 100%;
    height: 350px;
    color: red;
    font-size: 20px;
}
#upper_inner{
    height: 20%;
}
#lower_inner{
    width: 95%;
    margin-left: auto;
    margin-right: auto;
    position: relative;
    vertical-align: center;
    background-color: grey;
    height: 65%;
    opacity: 1;
    filter: alpha(opacity=100);
}

#left_side{
    float: left;
    height: 200px;
    width: 60%;
    margin: 5px;
    font-size: 16px;
    color: #888888;
    border-style: solid;
    border-width: 3px;
}

#map{
    width: 38%;
    height: 200px;
}

</style>

<!-- THIS JS SCRIPT IS TO RETRIEVE USER LOCATION AND
     TO DETERMINE NEARBY LOCATIONS               -->

<script>
$(document).ready(function(){
    GMaps.geolocate({
     success: function(position){
     //alert("made it into func");
         if ("{{=position_received}}" == "n") {
              window.location.assign('http://127.0.0.1:8000/HappyMerge/default/index?user_latitude=' + position.coords.latitude + '&user_longitude=' + position.coords.longitude);
         }
    },
    error: function(error){
      alert('Geolocation failed: '+error.message);
    },
    not_supported: function(){
      alert("Your browser does not support geolocation");
    }
  });
});
</script>

<!-- THIS JS SCRIPT IS TO RETRIEVE USER LOCATION AND
     TO MAP USER LOCATION               -->

<script>
 var map;
$(document).ready(function(){
  var map = new GMaps({
    el: '#map',
      lat: {{=user_latitude}},
      lng: {{=user_longitude}},
      zoom: 12
  });

  GMaps.geolocate({
    success: function(position){
      map.setCenter({{=user_latitude}}, {{=user_longitude}});

      map.addMarker({
        lat: {{=user_latitude}},
        lng: {{=user_longitude}},
        title: 'You are here.',
        infoWindow: {
          content: '<p>You are here!</p>'
        }
      });
    },
    error: function(error){
      alert('Geolocation failed: '+error.message);
    },
    not_supported: function(){
      alert("Your browser does not support geolocation");
    }
  });
});
</script>

{{backimage = URL('static', 'images/ph.png')}}
<div id="top_part" style="background-image: url('{{=backimage}}');">
    <div id="upper_inner"></div>
    <div id="lower_inner">
        <h2>
            Current Nearby Happy Hours:
        </h2>
        {{if len(posts) > 0:}}
        <ul>
            {{for p in posts:}}
                <li>
                    {{=A(p.name, _href=URL('default', 'view', args=[p.id]), _style='color: white')}}
                </li>
            {{pass}}
        </ul>
           {{else:}}
                There are no posts.
            {{pass}}
           <p>
                <!--  {{=A('Add Restaurant', _class='btn', _href=URL('default', 'create'))}}  -->
           </p>
    </div>
</div>
<br />
<hr style="background-color: #333; height: 2px; border: none;" />
<br/>
<div id="lower_content">
    
    <div id="left_side">
        Search Form Here
    <br/>
    <ul>
        <li>search result 1</li>
        <li>search result 2</li>
        <li>search result 3</li>
        <li>search result 4</li>
        <li>search result 5</li>
        <li>search result 6</li>
        <li>search result 7</li>
        <li>search result 8</li>
        <li>search result 9</li>
        <li>search result 10</li>
        <li>search result 11</li>
    <ul>
        </div>
        <div id="map"></div>
</div>
